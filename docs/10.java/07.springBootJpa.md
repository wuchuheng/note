---
title: springBootJpa
date: 2021-10-31
tags:
- Java
- SpringBoot
categories:
- Java
---

## 1 连接数据库配置示例
### 1.1 数据库配置文件 
``` yaml
spring:
   datasource:
     url: jdbc:mysql://localhost:3306/zhuche?characterEncoding=utf-8&serverTimezone=GMT%2B8
     username: root
     password: 12345678
jpa:
   hibernate:
     ddl-auto: create-drop # <-- 这里是每次启动时都重建数据表，适用于开发阶段，如果是生产环境的话，则写none才合适。
```
### 1.2 需要用到的`maven`依赖
``` xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-jpa</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-jdbc</artifactId>
</dependency>
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
</dependency>
```
<!--more-->
### 1.2 创建模型
``` java 
package com.zhuche.server.model;

import javax.persistence.*;
import java.util.List;

@Entity // <-- 加入持久化实例注解
@Table(name = "banner") // <-- 指定表名
public class BannerModel {
    @Id
    private long id; // <-- 字段 id

    private String name; // <-- 字段 name

    private String description; // <-- 字段 description

    private String img; // <-- 字段 img

    private String title; // <-- 字段 title
}
```
然后重启下应用，这在`zhuche`数据库中就已生成了一张名为`banner`的数据表了。

## 2 "1对多"示例
现有一个`banner`表，而`banner`下关联着`banner_item`表中的多条记录。这就是典型的`1对多`了。以下就是通过模型类的方式把这种关系描述
出来：
``` java
package com.zhuche.server.model;

import javax.persistence.*;
import java.util.List;

@Entity
@Table(name = "banner")
public class BannerModel {
    @Id
    private long id;

    private String name;

    private String description;

    private short type;

    private String img;

    private String title;

    @OneToMany
    @JoinColumn(name = "bannerId") // 本模型1对多子模型，且本模型的在子模型的外键名为: bannerId
    private List<BannerItemModel> Items;
}
```

``` java 
package com.zhuche.server.model;

import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity
@Table(name = "banner_item") // 这是子模型
public class BannerItemModel {
    @Id
    private long id;

    private String img;

    private String keyword;

    private short type;

    private String name;

    private Long bannerId; // 这是banner模型的外键
}
```
然后重启下应用，就会生成`banner`和`banner_item`这2个表了。
